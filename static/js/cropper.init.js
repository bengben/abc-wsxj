$(function(){var k=window.console||{log:function(){}};var q=window.URL||window.webkitURL;var i=$("#image");var h=$("#download");var f=$("#dataX");var g=$("#dataY");var a=$("#dataHeight");var e=$("#dataWidth");var b=$("#dataRotate");var c=$("#dataScaleX");var d=$("#dataScaleY");var l={aspectRatio:16/9,preview:".img-preview",crop:function(r){f.val(Math.round(r.detail.x));g.val(Math.round(r.detail.y));a.val(Math.round(r.detail.height));e.val(Math.round(r.detail.width));b.val(r.detail.rotate);c.val(r.detail.scaleX);d.val(r.detail.scaleY)}};var m=i.attr("src");var n="cropped.jpg";var o="image/jpeg";var p;$('[data-toggle="tooltip"]').tooltip();i.on({ready:function(r){k.log(r.type)},cropstart:function(r){k.log(r.type,r.detail.action)},cropmove:function(r){k.log(r.type,r.detail.action)},cropend:function(r){k.log(r.type,r.detail.action)},crop:function(r){k.log(r.type)},zoom:function(r){k.log(r.type,r.detail.ratio)}}).cropper(l);if(!$.isFunction(document.createElement("canvas").getContext)){$('button[data-method="getCroppedCanvas"]').prop("disabled",true)}if(typeof document.createElement("cropper").style.transition==="undefined"){$('button[data-method="rotate"]').prop("disabled",true);$('button[data-method="scale"]').prop("disabled",true)}if(typeof h[0].download==="undefined"){h.addClass("disabled")}$(".docs-toggles").on("change","input",function(){var r=$(this);var u=r.attr("name");var v=r.prop("type");var t;var s;if(!i.data("cropper")){return}if(v==="checkbox"){l[u]=r.prop("checked");t=i.cropper("getCropBoxData");s=i.cropper("getCanvasData");l.ready=function(){i.cropper("setCropBoxData",t);i.cropper("setCanvasData",s)}}else{if(v==="radio"){l[u]=r.val()}}i.cropper("destroy").cropper(l)});$(".docs-buttons").on("click","[data-method]",function(){var s=$(this);var v=s.data();var u=i.data("cropper");var t;var r;var x;if(s.prop("disabled")||s.hasClass("disabled")){return}if(u&&v.method){v=$.extend({},v);if(typeof v.target!=="undefined"){r=$(v.target);if(typeof v.option==="undefined"){try{v.option=JSON.parse(r.val())}catch(w){k.log(w.message)}}}t=u.cropped;switch(v.method){case"rotate":if(t&&l.viewMode>0){i.cropper("clear")}break;case"getCroppedCanvas":if(o==="image/jpeg"){if(!v.option){v.option={}}v.option.fillColor="#fff"}break}x=i.cropper(v.method,v.option,v.secondOption);switch(v.method){case"rotate":if(t&&l.viewMode>0){i.cropper("crop")}break;case"scaleX":case"scaleY":$(this).data("option",-v.option);break;case"getCroppedCanvas":if(x){$("#getCroppedCanvasModal").modal().find(".modal-body").html(x);if(!h.hasClass("disabled")){download.download=n;h.attr("href",x.toDataURL(o))}}break;case"destroy":if(p){q.revokeObjectURL(p);p="";i.attr("src",m)}break}if($.isPlainObject(x)&&r){try{r.val(JSON.stringify(x))}catch(w){k.log(w.message)}}}});$(document.body).on("keydown",function(r){if(!i.data("cropper")||this.scrollTop>300){return}switch(r.which){case 37:r.preventDefault();i.cropper("move",-1,0);break;case 38:r.preventDefault();i.cropper("move",0,-1);break;case 39:r.preventDefault();i.cropper("move",1,0);break;case 40:r.preventDefault();i.cropper("move",0,1);break}});var j=$("#inputImage");if(q){j.change(function(){var s=this.files;var r;if(!i.data("cropper")){return}if(s&&s.length){r=s[0];if(/^image\/\w+$/.test(r.type)){n=r.name;o=r.type;if(p){q.revokeObjectURL(p)}p=q.createObjectURL(r);i.cropper("destroy").attr("src",p).cropper(l);j.val("")}else{window.alert("Please choose an image file.")}}})}else{j.prop("disabled",true).parent().addClass("disabled")}});